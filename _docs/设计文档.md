# 时序图

## 博客
1. 获取博客

    ```sequence
    participant 前端(用户)
    participant 视图
    participant 数据库
    前端(用户)->视图: 获取博客(用户(组)|Tag(组)|题目|比赛(组)等)
    视图->视图: 检验合法
    视图->数据库: 查询数据库
    数据库->视图: 博客内容
    视图->前端(用户): 博客内容
    前端(用户)->前端(用户): 渲染博客内容
    ```

2. 新建/修改博客

    ```sequence
    participant 前端(用户)
    participant 视图
    participant 数据库
    前端(用户)->视图: 写博客请求(博客ID)
    视图->前端(用户): 博客编写页面
    前端(用户)->前端(用户): 写博客
    前端(用户)->视图: 新建/修改博客请求
    视图->视图: 检验博客内容合法性
    视图->前端(用户): 返回非法信息
    视图->数据库: 插入数据到数据库
    数据库->视图: 是否插入成功
    视图->前端(用户): 是否新建成功
    ```

2. 删除博客

    ```sequence
    participant 前端(用户)
    participant 视图
    participant 数据库
    前端(用户)->视图: 删除博客请求(博客ID)
    视图->视图: 检验是否合法
    视图->前端(用户): 返回非法信息
    视图->数据库: 删除数据
    数据库->视图: 是否删除成功
    视图->前端(用户): 是否删除成功
    ```

## 用户
1. 新建(修改)用户

    ```sequence
    participant 前端(用户)
    participant 视图
    participant 数据库
    前端(用户)->视图: 新建(修改)用户请求
    视图->前端(用户): 数据填写(修改)页面
    前端(用户)->前端(用户): 填写(修改)用户信息并检验
    前端(用户)->视图: 新建(修改)用户请求
    视图->视图: 检验请求
    视图->前端(用户): 返回非法信息
    视图->数据库: 插入用户信息
    数据库->视图: 是否插入成功
    视图->前端(用户): 是否新建(修改)成功
    ```

2. 删除用户

    ```sequence
    participant 前端(用户)
    participant 视图
    participant 数据库
    前端(用户)->视图: 删除用户请求(用户ID)
    视图->视图: 检验请求是否合法
    视图->前端(用户): 返回非法信息
    视图->数据库: 删除用户信息
    数据库->视图: 是否删除成功
    视图->前端(用户): 是否删除成功
    ```

3. 获取用户(组)

    ```sequence
    participant 前端(用户)
    participant 视图
    participant 数据库
    前端(用户)->视图: 发出获取用户(组)请求
    视图->视图: 检验请求是否合法
    视图-->前端(用户): 返回非法信息
    视图->数据库: 查询用户(组)
    数据库->视图: 返回所有的用户(组)ID和基本信息
    视图->前端(用户): 返回所有的用户(组)ID和基本信息
    ```

4. 登录/登出/注册/注销(正常流程)


5. 新建/修改角色

    类似新建/修改用户

6. 删除角色

    类似删除用户

## 数据统计

```sequence
participant 前端(用户)
participant 视图
participant 数据库
前端(用户)->视图: 发出获取统计数据的请求
视图->视图: 检验请求是否合法
视图-->前端(用户): 返回非法信息
视图->数据库: 查询数据库
数据库->视图: 返回统计信息
视图->前端(用户): 返回请求结果
前端(用户)->前端(用户): 渲染结果
```

## OJ

1. 提交题目
```sequence
participant 前端(用户)
participant 视图
participant JudgesCrawler
前端(用户)->视图: 提交题目请求
视图->视图: 检验请求是否合法
视图-->前端(用户): 返回非法信息
视图->JudgesCrawler: 提交题目
JudgesCrawler->JudgesCrawler: 评判题目
JudgesCrawler->视图: 返回提交题目结果
视图->前端(用户): 返回提交题目结果
```

2. 创建比赛

```sequence
participant 前端(用户)
participant 视图
participant 数据库
participant JudgesCrawler
前端(用户)->视图: 创建比赛页面请求
视图->前端(用户): 创建比赛页面
前端(用户)->前端(用户): 填写页面
前端(用户)->视图: 创建比赛请求
视图->视图: 检验请求是否合法
视图-->前端(用户): 返回非法信息
视图->JudgesCrawler: 获取所有题目信息
JudgesCrawler->视图: 返回所有题目
视图->数据库: 保存所有题目信息
数据库->视图: 是否保存成功
视图->前端(用户): 是否创建成功
```